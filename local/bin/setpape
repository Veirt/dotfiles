#!/bin/bash

wallpaper="$1"

setpape() {
    echo "output * bg '$1' fill" >~/.config/sway/conf.d/wallpaper
}

if [[ -z "$wallpaper" ]]; then
    wallpaper=$(find ~/pictures/wallpapers -type f | fzf)

    nohup imv $wallpaper &>/dev/null &

    read -p "Use as wallpaper [Y/n]: " query
    pkill $!

    if [ -z "$query" ] || [ "$query" = "Y" ] || [ "$query" = "y" ]; then
        :
    else
        exit 1
    fi
fi

wallpaper=$(printf %q "$wallpaper")
setpape "$wallpaper"
